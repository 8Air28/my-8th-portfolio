import streamlit as st

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ãƒ„ãƒ¼ãƒ«",
    page_icon="âš”ï¸",
    layout="centered"
)

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("âš” ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ãƒ„ãƒ¼ãƒ«")

st.markdown("""
ã“ã®ãƒ„ãƒ¼ãƒ«ã¯æ”»æ’ƒåŠ›ã¨é˜²å¾¡åŠ›ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ä¸ãˆã‚‹ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’è¨ˆç®—ã—ã¾ã™ã€‚  
å±æ€§ç›¸æ€§ãƒ»æ€¥æ‰€è£œæ­£ãƒ»å‘½ä¸­/å›é¿ã‚‚å¯¾å¿œã€‚çµæœã¯å±¥æ­´ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
""")

# æ”»æ’ƒå´å…¥åŠ›
st.subheader("âš” æ”»æ’ƒå´ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹")
attack = st.number_input("æ”»æ’ƒåŠ›", min_value=1, step=1, value=50)
æŠ€è£œæ­£ = st.slider("æŠ€è£œæ­£", 0.1, 3.0, 1.0, 0.1)
å±æ€§æ”»æ’ƒ = st.selectbox("æ”»æ’ƒå´å±æ€§", ["ç«", "æœ¨", "é›·", "æ°´", "å…‰", "é—‡"])
æ”»æ’ƒãƒ¬ãƒ™ãƒ« = st.number_input("æ”»æ’ƒå´ãƒ¬ãƒ™ãƒ«", min_value=1, step=1, value=50)
æ”»æ’ƒå›æ•° = st.number_input("æ”»æ’ƒå›æ•°", min_value=1, step=1, value=1)
æ€¥æ‰€ç‡ = st.slider("æ€¥æ‰€ç‡ (0ã€œ1)", 0.0, 1.0, 0.0, 0.1)
å‘½ä¸­ = st.slider("å‘½ä¸­ç‡ (%)", 0, 100, 100)

# é˜²å¾¡å´å…¥åŠ›
st.subheader("ğŸ›¡ é˜²å¾¡å´ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹")
defense = st.number_input("é˜²å¾¡åŠ›", min_value=0, step=1, value=30)
é˜²å¾¡è£œæ­£ = st.slider("é˜²å¾¡è£œæ­£", 0.1, 3.0, 1.0, 0.1)
å±æ€§é˜²å¾¡ = st.selectbox("é˜²å¾¡å´å±æ€§", ["ç«", "æœ¨", "é›·", "æ°´", "å…‰", "é—‡"])
é˜²å¾¡ãƒ¬ãƒ™ãƒ« = st.number_input("é˜²å¾¡å´ãƒ¬ãƒ™ãƒ«", min_value=1, step=1, value=50)
å›é¿ = st.slider("å›é¿ç‡ (%)", 0, 100, 0)

# è¨ˆç®—ãƒœã‚¿ãƒ³
if st.button("è¨ˆç®—ã™ã‚‹"):
    # å±æ€§è£œæ­£
    å±æ€§å€ç‡ = {
        ("ç«", "æœ¨"): 2.0,
        ("æœ¨", "é›·"): 2.0,
        ("é›·", "æ°´"): 2.0,
        ("æ°´", "ç«"): 2.0,
        ("å…‰", "é—‡"): 2.0,
        ("é—‡", "å…‰"): 2.0
    }
    å±æ€§è£œæ­£ = å±æ€§å€ç‡.get((å±æ€§æ”»æ’ƒ, å±æ€§é˜²å¾¡), 1.0)

    # æ€¥æ‰€è£œæ­£
    æ€¥æ‰€è£œæ­£ = 1.5 if æ€¥æ‰€ç‡ > 0 else 1.0

    # å‘½ä¸­ãƒ»å›é¿è¨ˆç®—
    å‘½ä¸­è£œæ­£ = (å‘½ä¸­ - å›é¿) / 100
    å‘½ä¸­è£œæ­£ = max(0, å‘½ä¸­è£œæ­£)  # 0æœªæº€ãªã‚‰å½“ãŸã‚‰ãªã„

    # ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—
    damage = max(1, (attack * æŠ€è£œæ­£ - defense * é˜²å¾¡è£œæ­£) * å±æ€§è£œæ­£ * æ€¥æ‰€è£œæ­£ * å‘½ä¸­è£œæ­£) * æ”»æ’ƒå›æ•°

    st.success(f"âœ… ä¸ãˆãŸãƒ€ãƒ¡ãƒ¼ã‚¸: {damage:.1f}")

    # å±¥æ­´ä¿å­˜
    if "å±¥æ­´" not in st.session_state:
        st.session_state.å±¥æ­´ = []
    st.session_state.å±¥æ­´.append(
        f"Lv{æ”»æ’ƒãƒ¬ãƒ™ãƒ«} {å±æ€§æ”»æ’ƒ}æ”»æ’ƒ â†’ Lv{é˜²å¾¡ãƒ¬ãƒ™ãƒ«} {å±æ€§é˜²å¾¡}é˜²å¾¡: {damage:.1f}ãƒ€ãƒ¡ãƒ¼ã‚¸"
    )

# å±¥æ­´è¡¨ç¤º
if "å±¥æ­´" in st.session_state and len(st.session_state.å±¥æ­´) > 0:
    st.markdown("---")
    st.subheader("ğŸ“œ è¨ˆç®—å±¥æ­´")
    for h in reversed(st.session_state.å±¥æ­´):
        st.write(h)

# ãƒ•ãƒƒã‚¿ãƒ¼
st.markdown("""
---
ä½œæˆè€…: 8Air28  
GitHub: [ã“ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª](https://github.com/8Air28/my-8th-portfolio)  
""")
